<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bag Authentication Guide - Vrai</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#89CFF0',
                        'primary-dark': '#7ab8d9',
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'],
                        'display': ['Playfair Display', 'serif'],
                    },
                }
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Shared Navigation and Authentication -->
    <script src="shared-navigation.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="min-h-screen bg-[#EAF6FC] font-sans text-[#1A1A1A] antialiased">
    <div class="w-full max-w-md mx-auto min-h-screen flex flex-col">
        <!-- Header -->
        <div class="bg-white px-4 py-4 border-b border-gray-100">
            <div class="flex items-center justify-between mb-2">
                <button onclick="window.location.href='index.html'" class="flex items-center justify-center w-10 h-10 rounded-lg">
                    <svg class="w-6 h-6 text-gray-600" viewBox="0 0 24 24" fill="none">
                        <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <h1 class="font-medium text-gray-900">Authentication Guide</h1>
                <div class="w-10"></div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 px-4 py-6 space-y-6">
            <!-- Title Section -->
            <div class="text-center">
                <h2 class="text-xl font-semibold text-gray-900 mb-2">Bag Authentication Guide</h2>
                <p class="text-sm text-gray-600">Take 10 guided photos of your bag. Each step will walk you through.</p>
            </div>

            <!-- Steps Grid -->
            <div class="grid grid-cols-2 gap-4">
                <!-- Step 1: Front -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="4" width="18" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M8 10L12 14L16 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Front</p>
                </div>

                <!-- Step 2: Back -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="4" width="18" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M16 10L12 14L8 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Back</p>
                </div>

                <!-- Step 3: Left Side -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <path d="M9 12L5 8V16L9 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <rect x="11" y="6" width="8" height="12" rx="1" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Left Side</p>
                </div>

                <!-- Step 4: Right Side -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <path d="M15 12L19 8V16L15 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <rect x="5" y="6" width="8" height="12" rx="1" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Right Side</p>
                </div>

                <!-- Step 5: Bottom -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <rect x="4" y="6" width="16" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
                        <circle cx="8" cy="18" r="1" fill="currentColor"/>
                        <circle cx="12" cy="18" r="1" fill="currentColor"/>
                        <circle cx="16" cy="18" r="1" fill="currentColor"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Bottom</p>
                </div>

                <!-- Step 6: Handles -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <rect x="5" y="10" width="14" height="8" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M8 10V7A3 3 0 0 1 16 7V10" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Handles</p>
                </div>

                <!-- Step 7: Hardware -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 1V6M12 18V23M4.22 4.22L7.76 7.76M16.24 16.24L19.78 19.78M1 12H6M18 12H23M4.22 19.78L7.76 16.24M16.24 7.76L19.78 4.22" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Hardware</p>
                </div>

                <!-- Step 8: Interior -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <path d="M3 7V17A2 2 0 0 0 5 19H19A2 2 0 0 0 21 17V7A2 2 0 0 0 19 5H5A2 2 0 0 0 3 7Z" stroke="currentColor" stroke-width="2"/>
                        <path d="M8 12H16M10 8H14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Interior</p>
                </div>

                <!-- Step 9: Stamps -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M9 9H15M9 13H12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="17" cy="7" r="2" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Stamps</p>
                </div>

                <!-- Step 10: Extras -->
                <div class="bg-white rounded-xl p-4 border border-gray-200 text-center">
                    <svg class="w-8 h-8 text-primary-500 mx-auto mb-2" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                        <rect x="7" y="7" width="10" height="10" rx="1" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 11V13M12 9H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <p class="text-sm font-semibold text-gray-900">Extras</p>
                </div>
            </div>

            <!-- Tip Section -->
            <div class="bg-white border border-[#D8E2F1] rounded-xl p-4 shadow-sm" style="background-color: #F4F7FB;">
                <div class="flex items-start">
                    <svg class="w-5 h-5 text-[#4A4A6A] mt-0.5 mr-3 flex-shrink-0" viewBox="0 0 24 24" fill="none">
                        <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1L14 2L20 8H4L10 2L9 1L3 7V9H4V19C4 20.1 4.9 21 6 21H18C19.1 21 20 20.1 20 19V9H21ZM6 19V9H18V19H6Z" fill="currentColor"/>
                    </svg>
                    <div>
                        <p class="text-sm font-medium text-[#4A4A6A]">ðŸ’¡ Photography Tip</p>
                        <p class="text-xs text-[#4A4A6A] mt-1">Make sure you're in a well-lit area before starting. Natural daylight works best for clear, detailed photos.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Action -->
        <div class="px-4 py-6">
            <button onclick="window.location.href='authenticate-step1.html'" class="w-full bg-[#89CFF0] text-white font-semibold py-3 rounded-lg text-sm flex items-center justify-center mb-8">
                <span>Start Authentication</span>
            </button>
        </div>

        <!-- Bottom padding for navigation -->
        <div class="h-20"></div>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-md bg-white border-t border-gray-100 py-3 px-4 shadow-sm z-50">
            <div class="flex justify-around items-center">
                <!-- Dashboard -->
                <a href="#" id="dashboard-link" class="flex flex-col items-center justify-center text-xs font-medium text-gray-400">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                        <path d="M3 13H11V3H3V13ZM3 21H11V15H3V21ZM13 21H21V11H13V21ZM13 3V9H21V3H13Z" fill="currentColor"/>
                    </svg>
                    <span class="mt-1">Dashboard</span>
                </a>
                <!-- Authenticate -->
                <a href="authenticate-guide.html" class="flex flex-col items-center justify-center text-xs font-medium text-[#89CFF0]">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                        <path d="M12 15.2C13.7673 15.2 15.2 13.7673 15.2 12C15.2 10.2327 13.7673 8.8 12 8.8C10.2327 8.8 8.8 10.2327 8.8 12C8.8 13.7673 10.2327 15.2 12 15.2ZM12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17ZM12 4.5C12.8284 4.5 13.5 3.82843 13.5 3C13.5 2.17157 12.8284 1.5 12 1.5C11.1716 1.5 10.5 2.17157 10.5 3C10.5 3.82843 11.1716 4.5 12 4.5ZM19 4.5C19.8284 4.5 20.5 3.82843 20.5 3C20.5 2.17157 19.8284 1.5 19 1.5C18.1716 1.5 17.5 2.17157 17.5 3C17.5 3.82843 18.1716 4.5 19 4.5ZM21 19H3C2.45 19 2 18.55 2 18V6C2 5.45 2.45 5 3 5H7L9 3H15L17 5H21C21.55 5 22 5.45 22 6V18C22 18.55 21.55 19 21 19ZM20 17H4V7H20V17Z" fill="currentColor"/>
                    </svg>
                    <span class="mt-1">Authenticate</span>
                </a>
                <!-- Settings -->
                <a href="settings.html" class="flex flex-col items-center justify-center text-xs font-medium text-gray-400">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                        <path d="M19.14 12.94C19.18 12.64 19.2 12.33 19.2 12C19.2 11.68 19.18 11.36 19.13 11.06L21.16 9.48C21.34 9.34 21.39 9.07 21.28 8.87L19.36 5.55C19.24 5.33 18.99 5.26 18.77 5.33L16.38 6.29C15.88 5.91 15.35 5.59 14.76 5.35L14.4 2.81C14.36 2.57 14.16 2.4 13.92 2.4H10.08C9.84 2.4 9.65 2.57 9.61 2.81L9.25 5.35C8.66 5.59 8.12 5.92 7.63 6.29L5.24 5.33C5.02 5.25 4.77 5.33 4.65 5.55L2.74 8.87C2.62 9.08 2.66 9.34 2.86 9.48L4.89 11.06C4.84 11.36 4.8 11.69 4.8 12C4.8 12.31 4.82 12.64 4.87 12.94L2.84 14.52C2.66 14.66 2.61 14.93 2.72 15.13L4.64 18.45C4.76 18.67 5.01 18.74 5.23 18.67L7.62 17.71C8.12 18.09 8.65 18.41 9.24 18.65L9.6 21.19C9.65 21.43 9.84 21.6 10.08 21.6H13.92C14.16 21.6 14.36 21.43 14.39 21.19L14.75 18.65C15.34 18.41 15.88 18.09 16.37 17.71L18.76 18.67C18.98 18.75 19.23 18.67 19.35 18.45L21.27 15.13C21.39 14.91 21.34 14.66 21.15 14.52L19.14 12.94ZM12 15.6C10.02 15.6 8.4 13.98 8.4 12C8.4 10.02 10.02 8.4 12 8.4C13.98 8.4 15.6 10.02 15.6 12C15.6 13.98 13.98 15.6 12 15.6Z" fill="currentColor"/>
                    </svg>
                    <span class="mt-1">Settings</span>
                </a>
                <!-- Admin -->
                <a href="admin.html" id="admin-nav-item" class="flex flex-col items-center justify-center text-xs font-medium text-gray-400 hidden">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                        <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 4L13.5 7H7V9H13.5L15 12L21 9ZM16 12C17.1 12 18 12.9 18 14S17.1 16 16 16 14 15.1 14 14 14.9 12 16 12ZM8 12C9.1 12 10 12.9 10 14S9.1 16 8 16 6 15.1 6 14 6.9 12 8 12ZM12 14C13.1 14 14 14.9 14 16S13.1 18 12 18 10 17.1 10 16 10.9 14 12 14ZM12 20C16.4 20 20 16.4 20 12S16.4 4 12 4 4 7.6 4 12 7.6 20 12 20Z" fill="currentColor"/>
                    </svg>
                    <span class="mt-1">Admin</span>
                </a>
            </div>
        </nav>
    </div>

    <script>
        // Session state validation and navigation management
        function validateSession() {
            const userEmail = sessionStorage.getItem('userEmail');
            const isAdmin = sessionStorage.getItem('isAdmin');
            
            // If no session data, redirect to login
            if (!userEmail) {
                console.log('No session found, redirecting to login...');
                window.location.href = 'index.html';
                return false;
            }
            
            console.log(`Session validated: User=${userEmail}, Admin=${isAdmin === 'true'}`);
            return true;
        }

        // Initialize navigation and admin status
        document.addEventListener('DOMContentLoaded', function() {
            // Validate session first (temporarily disabled for debugging)
            // if (!validateSession()) {
            //     return; // Will redirect to login
            // }
            
            // Set proper dashboard link based on admin status
            const dashboardLink = document.getElementById('dashboard-link');
            const isAdmin = sessionStorage.getItem('isAdmin') === 'true';
            dashboardLink.href = isAdmin ? 'dashboard-admin.html' : 'index.html';
            
            // Show admin navigation item if user is admin
            const adminNavItem = document.getElementById('admin-nav-item');
            if (isAdmin && adminNavItem) {
                adminNavItem.classList.remove('hidden');
            }
            
            // Add click handler to dashboard link with session check
            dashboardLink.addEventListener('click', function(e) {
                if (!validateSession()) {
                    e.preventDefault();
                    return;
                }
            });

            // Update the back button to go to the correct dashboard
            const backButton = document.querySelector('button[onclick*="index.html"]');
            if (backButton && isAdmin) {
                backButton.setAttribute('onclick', "window.location.href='dashboard-admin.html'");
            }
        });
    </script>

    <!-- Authentication Check -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-init.js"></script>
    <script src="supabase-auth.js"></script>
</body>
</html> 
