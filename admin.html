<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Vrai</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-init.js"></script>
    <script src="dashboard-admin.js"></script>
    <script src="admin-support.js"></script>
    <script src="admin-reports.js"></script>
    <script src="admin-stats-percentages.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#B0D6F8',
                        'primary-dark': '#89CFF0',
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'],
                        'display': ['Playfair Display', 'serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="min-h-screen bg-[#F9FAFB] font-sans text-[#1A1A1A] antialiased">
    <div class="w-full max-w-md mx-auto min-h-screen bg-[#F9FAFB]">
        <!-- Top App Bar -->
        <div class="bg-white shadow-sm sticky top-0 z-10">
            <div class="flex items-center justify-center px-6 py-4">
                <div class="w-10"></div>
                <h1 class="text-lg font-semibold text-gray-900">Admin Dashboard</h1>
                <div class="w-10"></div>
            </div>
        </div>

        <!-- Content Container -->
        <div class="px-4 py-6 space-y-6">
            <!-- Tab Navigation -->
            <div class="bg-white rounded-xl shadow-sm overflow-hidden">
                <div class="flex w-full">
                    <button class="tab-btn flex-1 py-3 px-4 text-sm font-medium text-center border-b-2 border-primary-dark text-primary-dark bg-blue-50" data-tab="auth">Auth</button>
                    <button class="tab-btn flex-1 py-3 px-4 text-sm font-medium text-center border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="support">Support</button>
                    <button class="tab-btn flex-1 py-3 px-4 text-sm font-medium text-center border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="report">Report</button>
                </div>
            </div>

            <!-- Tab Content -->
            <div id="tab-content">
                <!-- Auth Tab (Default Active) -->
                <div class="tab-panel active" data-tab-content="auth">
                    <!-- Stats Cards -->
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Total Submissions -->
                        <div class="bg-white rounded-xl p-4 shadow-sm">
                            <div class="flex items-center mb-2">
                                <div class="w-5 h-5 bg-blue-50 rounded-md flex items-center justify-center mr-2">
                                    <svg class="w-3 h-3 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                                </div>
                                <p class="text-xs font-medium text-neutral-600">Total Submissions</p>
                            </div>
                            <p class="text-2xl font-semibold text-gray-900 mb-1" data-stat="total-submissions">--</p>
                            <div class="flex items-center">
                                <span class="text-xs font-medium text-green-600 flex items-center">
                                    <svg class="w-3 h-3 mr-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                                    </svg>
                                    +12.5%
                                </span>
                            </div>
                        </div>

                        <!-- Pending Review -->
                        <div class="bg-white rounded-xl p-4 shadow-sm">
                            <div class="flex items-center mb-2">
                                <div class="w-5 h-5 bg-yellow-50 rounded-md flex items-center justify-center mr-2">
                                    <svg class="w-3 h-3 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <p class="text-xs font-medium text-neutral-600">Pending Review</p>
                            </div>
                            <p class="text-2xl font-semibold text-gray-900 mb-1" data-stat="pending-review">--</p>
                            <div class="flex items-center">
                                <span class="text-xs font-medium text-red-600 flex items-center">
                                    <svg class="w-3 h-3 mr-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                                    </svg>
                                    +8.3%
                                </span>
                            </div>
                        </div>

                        <!-- Processed Today -->
                        <div class="bg-white rounded-xl p-4 shadow-sm">
                            <div class="flex items-center mb-2">
                                <div class="w-5 h-5 bg-green-50 rounded-md flex items-center justify-center mr-2">
                                    <svg class="w-3 h-3 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </div>
                                <p class="text-xs font-medium text-neutral-600">Processed Today</p>
                            </div>
                            <p class="text-2xl font-semibold text-gray-900 mb-1" data-stat="approved-today">--</p>
                            <div class="flex items-center">
                                <span class="text-xs font-medium text-green-600 flex items-center">
                                    <svg class="w-3 h-3 mr-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                                    </svg>
                                    +22.1%
                                </span>
                            </div>
                        </div>

                        <!-- Active Users -->
                        <div class="bg-white rounded-xl p-4 shadow-sm">
                            <div class="flex items-center mb-2">
                                <div class="w-5 h-5 bg-purple-50 rounded-md flex items-center justify-center mr-2">
                                    <svg class="w-3 h-3 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                                    </svg>
                                </div>
                                <p class="text-xs font-medium text-neutral-600">Active Users</p>
                            </div>
                            <p class="text-2xl font-semibold text-gray-900 mb-1" data-stat="active-users">--</p>
                            <div class="flex items-center">
                                <span class="text-xs font-medium text-green-600 flex items-center">
                                    <svg class="w-3 h-3 mr-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                                    </svg>
                                    +5.7%
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- View All Submissions Button -->
                    <div class="px-2 mt-6">
                        <button onclick="window.location.href='admin-submissions.html'" class="w-full bg-primary-dark text-white font-semibold py-3 rounded-xl text-sm flex items-center justify-center space-x-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>View All Submissions</span>
                        </button>
                    </div>

                    <!-- Recent Activity Section -->
                    <div class="space-y-3 mt-8">
                        <!-- Title Bar -->
                        <div class="flex items-center justify-between px-2">
                            <h2 class="text-lg font-semibold text-gray-900">Recent Activity</h2>
                            <button onclick="window.location.href='activity-log.html'" class="text-sm font-medium text-primary-500 hover:text-primary-dark">View All</button>
                        </div>
                        
                        <!-- Activity Items (Limited to 3) -->
                        <div class="space-y-2" data-container="recent-activity">
                            <!-- Activity items will be populated by JavaScript -->
                            <div class="bg-white rounded-md p-3 shadow-sm">
                                <div class="flex items-center justify-center">
                                    <svg class="animate-spin h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Support Tab (Initially Hidden) -->
                <div class="tab-panel hidden" data-tab-content="support">
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">Support Management</h3>
                        <p class="text-sm text-gray-600 mb-4">Manage customer support tickets and inquiries.</p>
                        
                        <!-- Support Stats Summary -->
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-blue-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600 mb-1">Open Tickets</p>
                                <p id="open-tickets-count" class="text-xl font-semibold">--</p>
                            </div>
                            <div class="bg-green-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600 mb-1">Resolved Today</p>
                                <p id="resolved-today-count" class="text-xl font-semibold">--</p>
                            </div>
                        </div>
                        
                        <!-- Filter Options -->
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex space-x-2">
                                <button id="filter-pending" class="px-3 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800">
                                    Pending
                                </button>
                                <button id="filter-resolved" class="px-3 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-600">
                                    Resolved
                                </button>
                            </div>
                            <button id="refresh-support" class="text-xs text-primary-dark font-medium flex items-center">
                                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                Refresh
                            </button>
                        </div>
                    </div>
                    
                    <!-- Support Messages Container -->
                    <div id="support-messages-container" class="space-y-4">
                        <!-- Loading State -->
                        <div id="support-loading" class="bg-white rounded-xl p-6 shadow-sm text-center">
                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mb-2"></div>
                            <p class="text-gray-600">Loading support messages...</p>
                        </div>
                        
                        <!-- Empty State -->
                        <div id="support-empty" class="bg-white rounded-xl p-6 shadow-sm text-center hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900">No support messages</h3>
                            <p class="mt-1 text-sm text-gray-500">There are no pending support messages at this time.</p>
                        </div>
                        
                        <!-- Error State -->
                        <div id="support-error" class="bg-white rounded-xl p-6 shadow-sm text-center hidden">
                            <svg class="mx-auto h-12 w-12 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900">Error loading messages</h3>
                            <p class="mt-1 text-sm text-gray-500">Please try refreshing the page.</p>
                        </div>
                        
                        <!-- Messages List (will be populated by JavaScript) -->
                        <div id="support-messages-list" class="space-y-4 hidden">
                            <!-- Messages will be inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Report Tab (Initially Hidden) -->
                <div class="tab-panel hidden" data-tab-content="report">
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-4">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">User Problem Reports</h3>
                        <p class="text-sm text-gray-600 mb-4">View reports submitted by users about system issues.</p>
                        
                        <!-- Stats Summary -->
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-blue-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600 mb-1">Total Reports</p>
                                <p id="total-reports-count" class="text-xl font-semibold">--</p>
                            </div>
                            <div class="bg-yellow-50 rounded-lg p-3">
                                <p class="text-xs text-gray-600 mb-1">Pending Reports</p>
                                <p id="pending-reports-count" class="text-xl font-semibold">--</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Problem Reports Container -->
                    <div id="problem-reports-container">
                        <!-- Loading State -->
                        <div id="reports-loading" class="bg-white rounded-xl p-6 shadow-sm text-center">
                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mb-2"></div>
                            <p class="text-gray-600">Loading problem reports...</p>
                        </div>
                        
                        <!-- Empty State -->
                        <div id="reports-empty" class="bg-white rounded-xl p-6 shadow-sm text-center hidden">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900">No problem reports</h3>
                            <p class="mt-1 text-sm text-gray-500">There are no problem reports at this time.</p>
                        </div>
                        
                        <!-- Error State -->
                        <div id="reports-error" class="bg-white rounded-xl p-6 shadow-sm text-center hidden">
                            <svg class="mx-auto h-12 w-12 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
                            </svg>
                            <h3 class="mt-2 text-sm font-medium text-gray-900">Error loading reports</h3>
                            <p class="mt-1 text-sm text-gray-500">Please try refreshing the page.</p>
                        </div>
                        
                        <!-- Reports List (will be populated by JavaScript) -->
                        <div id="problem-reports-list" class="space-y-4 max-h-[500px] overflow-y-auto hidden">
                            <!-- Reports will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom padding for navigation -->
        <div class="h-20"></div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-md bg-white border-t border-gray-100 py-3 px-4 shadow-sm z-50">
        <div class="flex justify-around items-center">
            <!-- Dashboard -->
            <a href="dashboard-admin.html" class="flex flex-col items-center justify-center text-xs font-medium text-gray-400">
                <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                    <path d="M3 13H11V3H3V13ZM3 21H11V15H3V21ZM13 21H21V11H13V21ZM13 3V9H21V3H13Z" fill="currentColor"/>
                </svg>
                <span class="mt-1">Dashboard</span>
            </a>
            <!-- Authenticate -->
            <a href="authenticate-guide.html" class="flex flex-col items-center justify-center text-xs font-medium text-gray-400">
                <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                    <path d="M12 15.2C13.7673 15.2 15.2 13.7673 15.2 12C15.2 10.2327 13.7673 8.8 12 8.8C10.2327 8.8 8.8 10.2327 8.8 12C8.8 13.7673 10.2327 15.2 12 15.2ZM12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17ZM12 4.5C12.8284 4.5 13.5 3.82843 13.5 3C13.5 2.17157 12.8284 1.5 12 1.5C11.1716 1.5 10.5 2.17157 10.5 3C10.5 3.82843 11.1716 4.5 12 4.5ZM19 4.5C19.8284 4.5 20.5 3.82843 20.5 3C20.5 2.17157 19.8284 1.5 19 1.5C18.1716 1.5 17.5 2.17157 17.5 3C17.5 3.82843 18.1716 4.5 19 4.5ZM21 19H3C2.45 19 2 18.55 2 18V6C2 5.45 2.45 5 3 5H7L9 3H15L17 5H21C21.55 5 22 5.45 22 6V18C22 18.55 21.55 19 21 19ZM20 17H4V7H20V17Z" fill="currentColor"/>
                </svg>
                <span class="mt-1">Authenticate</span>
            </a>
            <!-- Settings -->
            <a href="settings.html" class="flex flex-col items-center justify-center text-xs font-medium text-gray-400">
                <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                    <path d="M19.14 12.94C19.18 12.64 19.2 12.33 19.2 12C19.2 11.68 19.18 11.36 19.13 11.06L21.16 9.48C21.34 9.34 21.39 9.07 21.28 8.87L19.36 5.55C19.24 5.33 18.99 5.26 18.77 5.33L16.38 6.29C15.88 5.91 15.35 5.59 14.76 5.35L14.4 2.81C14.36 2.57 14.16 2.4 13.92 2.4H10.08C9.84 2.4 9.65 2.57 9.61 2.81L9.25 5.35C8.66 5.59 8.12 5.92 7.63 6.29L5.24 5.33C5.02 5.25 4.77 5.33 4.65 5.55L2.74 8.87C2.62 9.08 2.66 9.34 2.86 9.48L4.89 11.06C4.84 11.36 4.8 11.69 4.8 12C4.8 12.31 4.82 12.64 4.87 12.94L2.84 14.52C2.66 14.66 2.61 14.93 2.72 15.13L4.64 18.45C4.76 18.67 5.01 18.74 5.23 18.67L7.62 17.71C8.12 18.09 8.65 18.41 9.24 18.65L9.6 21.19C9.65 21.43 9.84 21.6 10.08 21.6H13.92C14.16 21.6 14.36 21.43 14.39 21.19L14.75 18.65C15.34 18.41 15.88 18.09 16.37 17.71L18.76 18.67C18.98 18.75 19.23 18.67 19.35 18.45L21.27 15.13C21.39 14.91 21.34 14.66 21.15 14.52L19.14 12.94ZM12 15.6C10.02 15.6 8.4 13.98 8.4 12C8.4 10.02 10.02 8.4 12 8.4C13.98 8.4 15.6 10.02 15.6 12C15.6 13.98 13.98 15.6 12 15.6Z" fill="currentColor"/>
                </svg>
                <span class="mt-1">Settings</span>
            </a>
            <!-- Admin -->
            <a href="admin.html" class="flex flex-col items-center justify-center text-xs font-medium text-[#89CFF0]">
                <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 4L13.5 7H7V9H13.5L15 12L21 9ZM16 12C17.1 12 18 12.9 18 14S17.1 16 16 16 14 15.1 14 14 14.9 12 16 12ZM8 12C9.1 12 10 12.9 10 14S9.1 16 8 16 6 15.1 6 14 6.9 12 8 12ZM12 14C13.1 14 14 14.9 14 16S13.1 18 12 18 10 17.1 10 16 10.9 14 12 14ZM12 20C16.4 20 20 16.4 20 12S16.4 4 12 4 4 7.6 4 12 7.6 20 12 20Z" fill="currentColor"/>
                </svg>
                <span class="mt-1">Admin</span>
            </a>
        </div>
    </nav>

    <!-- Tab Switching JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get all tab buttons and panels
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabPanels = document.querySelectorAll('.tab-panel');
            
            // Add click event to each tab button
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.getAttribute('data-tab');
                    
                    // Deactivate all tabs
                    tabButtons.forEach(btn => {
                        btn.classList.remove('border-primary-dark', 'text-primary-dark', 'bg-blue-50');
                        btn.classList.add('border-transparent', 'text-gray-500');
                    });
                    
                    tabPanels.forEach(panel => {
                        panel.classList.add('hidden');
                    });
                    
                    // Activate selected tab
                    button.classList.remove('border-transparent', 'text-gray-500');
                    button.classList.add('border-primary-dark', 'text-primary-dark', 'bg-blue-50');
                    
                    // Show selected panel
                    const activePanel = document.querySelector(`.tab-panel[data-tab-content="${tabName}"]`);
                    activePanel.classList.remove('hidden');
                });
            });
        });
    </script>
</body>
</html>
